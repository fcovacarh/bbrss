{"ast":null,"code":"var _jsxFileName = \"/home/fvrh/Documentos/week8/bbrss/src/components/PianoRollComponent.jsx\";\nimport React, { Component } from \"react\";\nimport \"./PianoRollComponent.css\";\nexport default class PianoRollComponent extends Component {\n  componentDidMount() {\n    this.sequencer = document.querySelector(\"sequencer-\".concat(this.props.idx));\n    this.notes = [\"B\", \"A#\", \"A\", \"G#\", \"G\", \"F#\", \"F\", \"E\", \"D#\", \"D\", \"C#\", \"C\"];\n  }\n\n  createTable() {\n    const initialScale = 3,\n          toScale = 4,\n          rows = 12,\n          cols = 16;\n    let table = [];\n\n    for (let scale = toScale; scale > initialScale - 1; scale--) {\n      for (let i = 0; i < rows; i++) {\n        let row = [];\n        let step = true;\n        row.push(React.createElement(\"td\", {\n          key: this.notes[i] + scale,\n          className: \"note-cell\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 21\n          },\n          __self: this\n        }, this.notes[i] + scale));\n\n        for (let j = 0; j < cols; j++) {\n          if (j % 4 === 0) step = !step;\n          let classNameString = step ? \"cell-bar--darken\" : 'cell-bar';\n          row.push(React.createElement(\"td\", {\n            key: this.notes[i] + scale + j,\n            className: classNameString,\n            note: this.notes[i],\n            scale: scale,\n            step: j,\n            onClick: e => this.activateCell(e),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 30\n            },\n            __self: this\n          }));\n        }\n\n        table.push(React.createElement(\"tr\", {\n          key: \"row-\" + this.notes[i] + scale,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 40\n          },\n          __self: this\n        }, row));\n      }\n    }\n\n    return table;\n  }\n\n  activateCell(e) {\n    const element = e.target;\n    const step = element.getAttribute('step');\n    const otherCell = sequencer.querySelector(\"[step=\\\"\".concat(step, \"\\\"]\"));\n\n    if (otherCell.getAttribute('step') === step) {\n      otherCell.classList.remove('.cell-active');\n    }\n\n    element.classList.toggle(\"cell-active\");\n    this.reReadSequence();\n  }\n\n  reReadSequence() {\n    const cells = sequencer.querySelectorAll(\".cell-active\");\n    let sequence = new Array(16).fill(null);\n    cells.forEach(cell => {\n      let step = cell.getAttribute(\"step\");\n      let note = cell.getAttribute(\"note\");\n      let scale = cell.getAttribute(\"scale\");\n\n      if (typeof sequence[step] === \"string\" && sequence[step].length > 0) {\n        sequence[step] = [sequence[step], [note + scale]];\n      } else if (Array.isArray(sequence[step])) {\n        sequence[step].push([note + scale]);\n      } else {\n        sequence[step] = [note + scale];\n      }\n    });\n    this.props.updateSynthSequence(sequence);\n  }\n\n  render() {\n    return React.createElement(\"table\", {\n      id: \"sequencer-\".concat(this.props.idx),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, this.createTable()));\n  }\n\n}","map":{"version":3,"sources":["/home/fvrh/Documentos/week8/bbrss/src/components/PianoRollComponent.jsx"],"names":["React","Component","PianoRollComponent","componentDidMount","sequencer","document","querySelector","props","idx","notes","createTable","initialScale","toScale","rows","cols","table","scale","i","row","step","push","j","classNameString","e","activateCell","element","target","getAttribute","otherCell","classList","remove","toggle","reReadSequence","cells","querySelectorAll","sequence","Array","fill","forEach","cell","note","length","isArray","updateSynthSequence","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./PianoRollComponent.css\";\n\nexport default class PianoRollComponent extends Component {  \n  componentDidMount() {\n    this.sequencer = document.querySelector(`sequencer-${this.props.idx}`);\n    this.notes = [\"B\", \"A#\", \"A\", \"G#\", \"G\", \"F#\", \"F\", \"E\", \"D#\", \"D\", \"C#\", \"C\"];\n  }\n\n  createTable() {\n    const initialScale = 3,\n      toScale = 4,\n      rows = 12,\n      cols = 16;\n    let table = [];\n    for (let scale = toScale; scale > initialScale - 1; scale--) {\n      for (let i = 0; i < rows; i++) {\n        let row = [];\n        let step = true;\n        row.push(\n          <td key={this.notes[i] + scale} className=\"note-cell\">\n            {this.notes[i] + scale}\n          </td>\n        );\n\n        for (let j = 0; j < cols; j++) {\n          if (j % 4 === 0) step = !step;\n          let classNameString = step ? \"cell-bar--darken\" : 'cell-bar';\n          row.push(\n            <td\n              key={this.notes[i] + scale + j}\n              className={classNameString}\n              note={this.notes[i]}\n              scale={scale}\n              step={j}\n              onClick={e => this.activateCell(e)}\n            />\n          );\n        }\n        table.push(<tr key={\"row-\" + this.notes[i] + scale}>{row}</tr>);\n      }\n    }\n    return table;\n  }\n\n  activateCell(e) {\n    const element = e.target;\n    const step = element.getAttribute('step');\n    const otherCell = sequencer.querySelector(`[step=\"${step}\"]`);\n    if(otherCell.getAttribute('step') === step) { otherCell.classList.remove('.cell-active') }\n    element.classList.toggle(\"cell-active\");\n    this.reReadSequence();\n  }\n\n  reReadSequence() {\n    const cells = sequencer.querySelectorAll(\".cell-active\");\n    let sequence = new Array(16).fill(null);\n\n    cells.forEach(cell => {\n      let step = cell.getAttribute(\"step\");\n      let note = cell.getAttribute(\"note\");\n      let scale = cell.getAttribute(\"scale\");\n      if (typeof sequence[step] === \"string\" && sequence[step].length > 0) {\n        sequence[step] = [sequence[step], [note + scale]];\n      } else if (Array.isArray(sequence[step])) {\n        sequence[step].push([note + scale]);\n      } else {\n        sequence[step] = [note + scale];\n      }\n    });\n    this.props.updateSynthSequence(sequence);\n  }\n\n  render() {\n    return (\n      <table id={`sequencer-${this.props.idx}`}>\n        <tbody>{this.createTable()}</tbody>\n      </table>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}